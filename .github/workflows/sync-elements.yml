name: Sync Elements

on:
  workflow_dispatch:
    inputs:
      scope:
        description: "What to sync/export (sent by extension)"
        required: false
        default: "all"
      export_path:
        description: "Path to the exported flows JSON (sent by extension)"
        required: false
        default: "exports/latest-export.json"
      branch:
        description: "Branch name (sent by extension)"
        required: false
        default: "main"
      commitSha:
        description: "Commit SHA created by the extension (optional)"
        required: false

jobs:
  sync-elements:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          ref: ${{ inputs.branch || github.ref_name }}
          fetch-depth: 0

      - name: Log inputs (debug)
        run: |
          echo "scope=${{ inputs.scope }}"
          echo "export_path=${{ inputs.export_path }}"
          echo "branch=${{ inputs.branch }}"
          echo "commitSha=${{ inputs.commitSha }}"
          echo "github.ref=${{ github.ref }}"

      - name: Check if export file exists
        run: |
          if [ -f "${{ inputs.export_path }}" ]; then
            echo "✅ Found export file at '${{ inputs.export_path }}'"
          else
            echo "⚠️ Export file not found at '${{ inputs.export_path }}' (workflow still OK as placeholder)."
          fi

      - name: Placeholder
        run: echo "✅ sync-elements workflow exists and completed."
